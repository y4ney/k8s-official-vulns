---CVSS 评分: [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) (评分: 8.8，高危)

在 [ingress-nginx](https://github.com/kubernetes/ingress-nginx) 中发现一个安全问题，其中 `auth-tls-match-cn` Ingress 注解可用于向 nginx 注入配置。这可能导致在 ingress-nginx 控制器的上下文中执行任意代码，并泄露控制器可访问的 Secrets。（请注意，在默认安装中，控制器可以访问集群范围内的所有 Secrets。）

### 我是否受影响？

此问题影响 ingress-nginx。如果您的集群中未安装 ingress-nginx，则不受影响。您可以通过运行 `kubectl get pods --all-namespaces --selector app.kubernetes.io/name=ingress-nginx` 来检查。

#### 受影响版本

- < v1.11.0
- v1.11.0 \- 1.11.4  
- v1.12.0

### 如何缓解此漏洞？

**必须采取以下措施来缓解此漏洞：** 将 ingress-nginx 升级到 v1.11.5、v1.12.1 或任何更高版本。

#### 修复版本

- ingress-nginx [main@06c992a](https://github.com/kubernetes/ingress-nginx/pull/13068/commits/06c992abd8eef9710359a236c443c613d29fdfad)

升级请参考文档：[升级 Ingress-nginx](https://kubernetes.github.io/ingress-nginx/deploy/upgrade/)

### 检测

Ingress 资源中 `auth-tls-match-cn` 注解内的可疑数据可能表明有人试图利用此漏洞。

如果您发现此漏洞已被利用的证据，请联系 security@kubernetes.io

#### 致谢

此漏洞由 Wiz 的 Nir Ohfeld、Ronen Shustin、Sagi Tzadik 和 Hillai Ben Sasson 报告

问题由 Marco Ebert、James Strong、Tabitha Sable 和 Kubernetes 安全响应委员会修复和协调