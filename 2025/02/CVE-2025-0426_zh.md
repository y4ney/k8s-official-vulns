---CVSS 评分: [CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)

在 Kubernetes 中发现一个安全问题：向未认证的 kubelet 只读 HTTP 端点发送大量容器检查点请求可能导致节点磁盘被填满，从而引发节点拒绝服务。

### 我是否受影响？

所有运行以下受影响版本且启用了 kubelet 只读 HTTP 端口，并使用支持容器检查点功能的容器运行时（如 CRI-O v1.25.0+（设置 `enable_criu_support` 为 true）或安装有 `criu` 的 containerd v2.0+）的集群都会受到影响。

#### 受影响版本

- kubelet v1.32.0 至 v1.32.1
- kubelet v1.31.0 至 v1.31.5
- kubelet v1.30.0 至 v1.30.9

### 如何缓解此漏洞？

可通过以下方式缓解此问题：在 kubelet 配置中将 `ContainerCheckpoint` 特性门控设置为 `false`、禁用 kubelet 只读端口、限制对 kubelet API 的访问，或升级至以下已修复版本（这些版本强制要求对 kubelet Checkpoint API 进行认证）。

#### 已修复版本

- kubelet master - 由 #129739 修复
- kubelet v1.32.2 - 由 #130010 修复
- kubelet v1.31.6 - 由 #130011 修复
- kubelet v1.30.10 - 由 #130012 修复
- kubelet v1.29.14 - 由 #130014 修复
  - 注：容器检查点支持在 v1.25-v1.29 版本中是默认关闭的 Alpha 特性

### 检测方法

节点上出现大量对 kubelet 只读 HTTP 服务器 `/checkpoint` 端点的请求，或（默认情况下）在 `/var/lib/kubelet/checkpoints` 目录下存储大量检查点文件，可能表明有人正在利用此漏洞尝试发起拒绝服务攻击。

如发现此漏洞被利用的证据，请联系 security@kubernetes.io

#### 致谢

此漏洞由 Google 的 Tim Allclair @tallclair 报告并修复。

问题协调人员：

Tim Allclair @tallclair  
Sascha Grunert saschagrunert@  
Craig Ingram @cji  
Jordan Liggitt liggitt@  

/triage accepted  
/lifecycle frozen  
/area security  
/kind bug  
/committee security-response  
/label official-cve-feed  
/sig node  
/area kubelet