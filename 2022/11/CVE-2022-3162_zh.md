---CVSS 评分: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

Kubernetes 中发现一个安全问题：被授权在集群范围内列出或监视某一种命名空间自定义资源的用户，可以在未经授权的情况下读取同一 API 组中其他类型的自定义资源。

### 我是否受影响？

如果满足以下所有条件，集群将受此漏洞影响：
- 存在 2 个或以上共享同一 API 组的 CustomResourceDefinition
- 用户对其中一种自定义资源拥有集群范围的列出或监视权限
- 同一用户未被授权读取同一 API 组中的另一种自定义资源

#### 受影响版本

- Kubernetes kube-apiserver <= v1.25.3
- Kubernetes kube-apiserver <= v1.24.7
- Kubernetes kube-apiserver <= v1.23.13
- Kubernetes kube-apiserver <= v1.22.15

### 如何缓解此漏洞？

将 kube-apiserver 升级至修复版本可缓解此漏洞。

在升级前，可通过避免授予集群范围的列出和监视权限来缓解此漏洞。

#### 修复版本

- Kubernetes kube-apiserver v1.25.4
- Kubernetes kube-apiserver v1.24.8
- Kubernetes kube-apiserver v1.23.14
- Kubernetes kube-apiserver v1.22.16

### 检测方法

请求路径中包含 `..` 的请求可能是漏洞利用的迹象。请求路径可能记录在 API 审计日志或 kube-apiserver HTTP 日志中。

如发现此漏洞被利用的证据，请联系 security@kubernetes.io

#### 致谢

此漏洞由 NCC Group 的 Richard Turnbull 作为 Kubernetes 审计的一部分报告。

<!-- labels -->
/area security
/kind bug
/committee security-response
/label official-cve-feed
/sig api-machinery
/area apiserver