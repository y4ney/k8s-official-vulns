### 问题详情  
在 [ingress-nginx](https://github.com/kubernetes/ingress-nginx) 中发现一个安全问题：能够创建或更新 Ingress 对象的用户可利用换行符绕过 Ingress 对象（属于 `networking.k8s.io` 或 `extensions` API 组）中 `spec.rules[].http.paths[].path` 字段的过滤机制，从而获取 ingress-nginx 控制器的凭据。在默认配置下，该凭据拥有访问集群中所有 Secret 的权限。  

此问题被评为高危（[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L)），并分配了 CVE-2021-25748。  

### 受影响组件及配置  
此漏洞影响 ingress-nginx。若集群未安装 ingress-nginx，则不受影响。可通过运行 `kubectl get po -n ingress-nginx` 确认。  

如果使用的是 v1.2.0 版本引入的“chrooted” ingress-nginx 控制器（gcr.io/k8s-staging-ingress-nginx/controller-chroot），则不受影响。  

允许非管理员用户创建 Ingress 对象的多租户环境受此问题影响最为严重。  

#### 受影响版本  
<v1.2.1  

#### 已修复版本  
v1.2.1  

### 缓解措施  
若无法立即修复，可通过实施准入策略限制 `networking.k8s.io/Ingress` 资源中 `spec.rules[].http.paths[].path` 字段仅允许已知安全字符来缓解此漏洞（参见新增的 [rules](https://github.com/kubernetes/ingress-nginx/blame/main/internal/ingress/inspector/rules.go) 或 [annotation-value-word-blocklist](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#annotation-value-word-blocklist) 的建议值）。  

### 检测  
如发现此漏洞被利用的证据，请联系 [security@kubernetes.io](mailto:security@kubernetes.io)。  

### 更多详情  
参见 ingress-nginx Issue [#8686](https://github.com/kubernetes/kubernetes/issues/126814)。  

### 致谢  
此漏洞由 Gafnit Amiga 报告。  

此致，  
Kubernetes 安全响应委员会代表 CJ Cullen