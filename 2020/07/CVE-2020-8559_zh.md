---  
CVSS 评分：中危 (6.4) [CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H)  

如果攻击者能够拦截发往 Kubelet 的特定请求，他们可以发送重定向响应，客户端可能会使用原始请求的凭据跟随该重定向。这可能导致其他节点被入侵。  

如果多个集群共享客户端信任的同一证书颁发机构和相同的身份验证凭据，此漏洞可能允许攻击者将客户端重定向到另一个集群。在此配置中，该漏洞应被视为**高危**严重性。  

### 我是否受影响？  

仅当您将节点视为安全边界，或集群间共享证书颁发机构和身份验证凭据时，才会受此漏洞影响。  

请注意，此漏洞需要攻击者首先通过其他方式入侵节点。  

#### 受影响版本  

- kube-apiserver v1.18.0-1.18.5  
- kube-apiserver v1.17.0-1.17.8  
- kube-apiserver v1.16.0-1.16.12  
- 所有早于 v1.16.0 的 kube-apiserver 版本  

### 如何缓解此漏洞？  

要缓解此漏洞，必须将 kube-apiserver 升级到已修复版本。  

#### 已修复版本  

- kube-apiserver master - 通过 https://github.com/kubernetes/kubernetes/pull/92941 修复  
- kube-apiserver v1.18.6 - 通过 https://github.com/kubernetes/kubernetes/pull/92969 修复  
- kube-apiserver v1.17.9 - 通过 https://github.com/kubernetes/kubernetes/pull/92970 修复  
- kube-apiserver v1.16.13 - 通过 https://github.com/kubernetes/kubernetes/pull/92971 修复  

**修复影响：** 此补丁可能导致响应升级请求时返回非 101 状态码的代理后端（如扩展 API 服务器）出现故障。  

升级方法请参考文档：https://kubernetes.io/docs/tasks/administer-cluster/cluster-management/#upgrading-a-cluster  

### 检测  

升级请求绝不应返回重定向响应。如果以下任何请求的响应代码在 300-399 范围内，则可能是漏洞被利用的证据。这些信息可在 Kubernetes 审计日志中找到。  

- pods/exec  
- pods/attach  
- pods/portforward  
- 任何资源的 proxy 请求  

如发现此漏洞被利用的证据，请联系 security@kubernetes.io  

#### 致谢  

此漏洞由 Offensi 的 Wouter ter Maat 通过 Kubernetes 漏洞赏金计划报告。  

/area security  
/kind bug  
/committee product-security  
/sig api-machinery  
/area apiserver