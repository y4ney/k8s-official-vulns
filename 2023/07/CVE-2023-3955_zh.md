---CVSS 评分：[CVSS:3.1/av:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) - **高危** (8.8)

在 Kubernetes 中发现一个安全漏洞，能够在 Windows 节点上创建 Pod 的用户可能提升至该节点的管理员权限。仅包含 Windows 节点的 Kubernetes 集群会受到影响。

### 我是否受影响？

任何包含 Windows 节点的 Kubernetes 环境均受影响。执行 `kubectl get nodes -l kubernetes.io/os=windows` 可查看当前是否使用 Windows 节点。

#### 受影响版本

- kubelet <= v1.28.0  
- kubelet <= v1.27.4  
- kubelet <= v1.26.7  
- kubelet <= v1.25.12  
- kubelet <= v1.24.16  

### 如何缓解此漏洞？

提供的补丁可完全修复该漏洞（修复影响见下文）。彻底解决此类问题需要同时应用 CVE-2023-3676、CVE-2023-3955 和 CVE-2023-3893 的补丁。

除应用补丁外，目前没有其他已知缓解措施。

#### 修复版本

- kubelet master - 由 #120128 修复  
- kubelet v1.28.1 - 由 #120134 修复  
- kubelet v1.27.5 - 由 #120135 修复  
- kubelet v1.26.8 - 由 #120136 修复  
- kubelet v1.25.13 - 由 #120137 修复  
- kubelet v1.24.17 - 由 #120138 修复  

**修复影响：** 向内置卷插件传递 Windows Powershell 磁盘格式化参数将导致节点上的卷配置失败。目前未发现该功能的实际使用场景，也没有已知的第三方 CSI 驱动支持此功能。

升级指南请参阅文档：  
https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/

### 检测方法

可通过 Kubernetes 审计日志检测是否正在利用此漏洞。包含嵌入式 powershell 命令的 Pod 创建事件是明显的攻击迹象。

如发现漏洞利用证据，请联系 security@kubernetes.io

#### 致谢

此漏洞由 James Sturtevant @jsturtevant 和 Mark Rossetti @marosset 在修复 CVE-2023-3676 过程中发现（原始 CVE 由 Tomer Peled @tomerpeled92 报告）

修复与协调团队：  
James Sturtevant @jsturtevant  
Mark Rossetti @marosset  
Andy Zhang @andyzhangx  
Justin Terry @jterry75  
Kulwant Singh @KlwntSingh  
Micah Hausler @micahhausler  
Rita Zhang @ritazh  

以及发布经理：  
Jeremy Rickard @jeremyrickard